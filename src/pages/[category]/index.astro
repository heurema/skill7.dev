---
import Base from "../../layouts/Base.astro";
import Breadcrumb from "../../components/Breadcrumb.astro";
import PluginCard from "../../components/PluginCard.astro";
import CopyButton from "../../components/CopyButton.astro";
import { getCategories, getPluginsByCategory } from "../../lib/data";

export function getStaticPaths() {
  return getCategories().map((cat) => ({
    params: { category: cat.name },
    props: { category: cat },
  }));
}

const { category } = Astro.props;
const plugins = getPluginsByCategory(category.name);
---

<Base
  title={category.displayName}
  description={`${category.description}. Claude Code plugins from skill7.`}
>
  <Breadcrumb items={[
    { label: "Home", href: "/" },
    { label: category.displayName },
  ]} />

  <div class="mb-8">
    <h1 class="font-heading font-bold tracking-tight">{category.displayName}</h1>
    <p class="mt-2 text-lg text-dark-lo">{category.description}</p>
  </div>

  <div class="card-sm mb-8">
    <p class="mb-3 text-sm text-dark-lo font-mono">
      Register the marketplace (once), then install any plugin:
    </p>
    <CopyButton text="claude plugin marketplace add heurema/emporium" />
  </div>

  <div class="grid gap-4 sm:grid-cols-2">
    {plugins.map((plugin) => (
      <PluginCard plugin={plugin} />
    ))}
  </div>

  {plugins.length === 0 && (
    <div class="mt-12 text-center py-16">
      <p class="text-dark-dim font-mono text-sm">No plugins in this category yet.</p>
      <a href="/" class="mt-6 inline-block btn-secondary">Browse all plugins</a>
    </div>
  )}
</Base>
