---
import Base from "../layouts/Base.astro";
import PluginCard from "../components/PluginCard.astro";
import CopyButton from "../components/CopyButton.astro";
import { getCategories, getFeaturedPlugins, getAllPlugins } from "../lib/data";

const categories = getCategories();
const featured = getFeaturedPlugins(4);
const totalPlugins = getAllPlugins().length;
---

<Base title="Marketplace" description="Curated open-source plugin marketplace for Claude Code. Browse by category, install in one command.">
  <!-- Hero -->
  <section class="py-16 text-center">
    <h1 class="text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl">
      Extend Claude Code in One Command
    </h1>
    <p class="mx-auto mt-4 max-w-2xl text-lg text-gray-600">
      Curated open-source plugins for Claude Code. Browse by category, install in one command.
    </p>
    <p class="mt-3 text-sm text-gray-500">
      {totalPlugins} plugins &middot; {categories.length} {categories.length === 1 ? "category" : "categories"} &middot; all open source
    </p>

    <div class="mx-auto mt-8 max-w-lg">
      <CopyButton text="claude plugin install sigil@emporium" />
    </div>

    <div class="mt-8 flex flex-col sm:flex-row justify-center gap-4">
      <a href="/getting-started" class="btn-primary">Get Started</a>
      <a href="https://github.com/heurema/emporium" class="rounded-lg border border-gray-300 px-4 py-2 font-medium text-gray-700 hover:bg-gray-50 transition-colors" target="_blank" rel="noopener">
        View on GitHub
      </a>
    </div>
  </section>

  <!-- Categories -->
  <section class="py-12">
    <h2 class="text-2xl font-bold text-gray-900">Categories</h2>
    <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {categories.map((cat) => (
        <a href={`/${cat.name}`} class="card block group">
          <h3 class="font-semibold text-gray-900 group-hover:text-brand-600 transition-colors">
            {cat.displayName}
          </h3>
          <p class="mt-2 text-sm text-gray-600">{cat.description}</p>
        </a>
      ))}
    </div>
  </section>

  <!-- Featured Plugins -->
  <section class="py-12">
    <h2 class="text-2xl font-bold text-gray-900">Featured Plugins</h2>
    <div class="mt-6 grid gap-4 sm:grid-cols-2">
      {featured.map((plugin) => (
        <PluginCard plugin={plugin} />
      ))}
    </div>
  </section>
</Base>
