---
import Base from "../layouts/Base.astro";
import PluginCard from "../components/PluginCard.astro";
import CopyButton from "../components/CopyButton.astro";
import GitHubIcon from "../components/icons/GitHubIcon.astro";
import { getCategories, getFeaturedPlugins, getAllPlugins } from "../lib/data";

const categories = getCategories();
const featured = getFeaturedPlugins(4);
const totalPlugins = getAllPlugins().length;
---

<Base title="Marketplace" description="Curated open-source plugin marketplace for Claude Code. Browse by category, install in one command.">

  <!-- Hero ------------------------------------------------------------------>
  <section class="relative py-20 text-center overflow-hidden">
    <!-- Dot grid background -->
    <div class="absolute inset-0 bg-dots opacity-40 pointer-events-none" />

    <!-- Glow orbs -->
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 rounded-full pointer-events-none"
         style="background: radial-gradient(circle, rgba(0,229,160,0.06) 0%, transparent 70%);"></div>
    <div class="absolute top-1/3 left-1/3 w-64 h-64 rounded-full pointer-events-none"
         style="background: radial-gradient(circle, rgba(0,180,216,0.04) 0%, transparent 70%);"></div>

    <div class="relative">
      <!-- Eyebrow -->
      <div class="cursor-default inline-flex items-center gap-2 px-3 py-1 rounded-full border border-acid/30 bg-acid-muted mb-6">
        <span class="w-1.5 h-1.5 rounded-full bg-acid animate-pulse"></span>
        <span class="text-xs font-mono font-medium text-acid">Claude Code Plugin Marketplace</span>
      </div>

      <h1 class="font-heading font-bold tracking-tight">
        <span class="text-gradient-hero">Extend Claude Code</span>
        <br />
        <span class="text-dark-hi">in Two Commands</span>
      </h1>

      <p class="mx-auto mt-6 max-w-xl text-lg text-dark-lo leading-relaxed">
        Curated open-source plugins. Browse by category, install instantly.
        Built by the <a href="https://github.com/heurema" class="text-acid hover:text-acid-glow transition-colors">heurema</a> collective.
      </p>

      <p class="mt-3 text-sm text-dark-lo font-mono">
        {totalPlugins} plugins &nbsp;·&nbsp; {categories.length} {categories.length === 1 ? "category" : "categories"} &nbsp;·&nbsp; all open source
      </p>

      <div class="mx-auto mt-8 max-w-lg space-y-3">
        <div>
          <p class="mb-1.5 text-xs text-dark-lo font-mono">
            <span class="text-acid">1</span> — Register once
          </p>
          <CopyButton text="claude plugin marketplace add heurema/emporium" />
        </div>
        <div>
          <p class="mb-1.5 text-xs text-dark-lo font-mono">
            <span class="text-acid">2</span> — Install any plugin
          </p>
          <CopyButton text="claude plugin install sigil@emporium" />
        </div>
      </div>

      <div class="mt-6 flex flex-col sm:flex-row justify-center gap-3">
        <a href="/getting-started" class="btn-primary w-full sm:w-auto justify-center">Get Started</a>
        <a
          href="https://github.com/heurema/emporium"
          class="btn-secondary w-full sm:w-auto justify-center"
          target="_blank"
          rel="noopener"
        >
          <GitHubIcon />
          View on GitHub
        </a>
      </div>
    </div>
  </section>

  <!-- Categories ----------------------------------------------------------->
  <section class="py-12">
    <div class="flex items-center gap-3 mb-6">
      <h2 class="heading-section text-2xl">Categories</h2>
    </div>
    <div class="grid gap-4 sm:grid-cols-2">
      {categories.map((cat) => (
        <a href={`/${cat.name}`} class="card block group">
          <h3 class="heading-section text-xl group-hover:text-acid transition-colors">
            {cat.displayName}
          </h3>
          <p class="mt-2 text-sm text-dark-lo leading-relaxed">{cat.description}</p>
        </a>
      ))}
    </div>
  </section>

  <!-- All Plugins ---------------------------------------------------------->
  <section class="py-12 border-t border-dark-line">
    <div class="flex items-center gap-3 mb-6">
      <h2 class="heading-section text-2xl">All Plugins</h2>
    </div>
    <div class="grid gap-4 sm:grid-cols-2">
      {featured.map((plugin) => (
        <PluginCard plugin={plugin} />
      ))}
    </div>
  </section>

</Base>
